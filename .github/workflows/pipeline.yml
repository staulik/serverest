name: Automation - Python>>>Behave>>>Pytest

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: 3.11

      - name: Instalar dependÃªncias
        run: |
          python -m pip install --upgrade pip
          pip install behave behave-html-formatter

      - name: Rodar os testes com Behave e gerar relatÃ³rio HTML
        run: |
          mkdir -p reports
          behave -f html -o reports/BBVA_qa_test_report.html aut_api/features

      - name: Enviar e-mail com relatÃ³rio
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 465
          username: ${{ secrets.EMAIL_USERNAME }}
          password: ${{ secrets.EMAIL_PASSWORD }}
          subject: "BBVA Regression Test Exchange Matera âœ…"
          to: silvio.aulik@gmail.com
          cc: staulik10@gmail.com, qatadeu@gmail.com
          from: BBVA Regression Test Report
          content_type: html
          body: |
            <h2>ðŸ“Š RelatÃ³rio de Testes Automatizados</h2>
            <p>Segue em anexo o relatÃ³rio da Ãºltima execuÃ§Ã£o dos testes.</p>
            <p>Status: <strong>Sucesso</strong></p>
            <p>Anexo incluÃ­do:</p>
            <ul>
              <li>ðŸ“„ <strong>RelatÃ³rio HTML</strong></li>
            </ul>
            <p style="margin-top: 20px;">ðŸ’ª Pipeline executada com sucesso!</p>
          attachments: reports/BBVA_qa_test_report.html

















